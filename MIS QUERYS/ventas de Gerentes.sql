SELECT c.IdClase,DOCID, CUSTNMBR,CUSTNAME,SOPNUMBE,DOCDATE,ITEMNMBR,ITEMDESC,UNITPRCE,QUANTITY,XTNDPRCE, c.IdZona,c.NombreRuta,c.ZonaResponsable
FROM dbo.vw_VentasGPconConduceCA1 v INNER JOIN  vw_Clientes_CSR c ON RTRIM(v.CUSTNMBR)=RTRIM(c.CodCliente) 
WHERE   DOCDATE BETWEEN '20160501' AND '20160531' AND DOCID NOT IN( 'A0100800101','A0100800115','A0100800114')  AND ITEMNMBR LIKE 'PT[349]%' AND LOCNCODE='SANISIDRO' AND NombreRuta LIKE 'SD[139]%'
            
 

--SELECT * FROM vw_Clientes_CSR 


SELECT DOCID, CUSTNMBR,CUSTNAME,SOPNUMBE,DOCDATE,ITEMNMBR,ITEMDESC,UNITPRCE,QUANTITY,XTNDPRCE, IdZona,NombreRuta,ZonaResp
FROM dbo.vw_VentasGPconConduceC
WHERE DOCDATE BETWEEN '20150901' AND '20150930' AND DOCID <> 'A0100800101'  AND ITEMNMBR='PT300'   AND NombreRuta LIKE 'SD3%'



SELECT * FROM PalmComSync..OUT_CLIENTES
WHERE CODCLIE='34054'


SELECT DOCID, CUSTNMBR,CUSTNAME,SOPNUMBE,DOCDATE,ITEMNMBR,ITEMDESC,UNITPRCE,QUANTITY,XTNDPRCE
FROM dbo.vw_VentasGPconConduceCA1 
WHERE  DOCDATE BETWEEN '20150701' AND '20151031' AND LOCNCODE='BAVARO'



 SELECT * FROM GPHN..vw_VentasGP1
 WHERE LOCNCODE='BAVARO' AND ITEMNMBR='PT300' AND DOCDATE BETWEEN '20141101' AND '20151031' AND CUSTNMBR  IN ('40531','40913','25416')

 SELECT * FROM GPHN.dbo.vw_VentasGPconConduceCA1 
 WHERE CUSTNMBR IN ( '10155',
'15895',
'18027',
'18982',
'21346',
'30344',
'31711',
'33325',
'33336',
'33884',
'33921',
'34214'

) AND DOCDATE BETWEEN '20151001' AND '20151031'
 
 
 
 SELECT * FROM PalmComSync..GP_CLIENTEDIASRUTA
 WHERE CodCliente IN (  SELECT CUSTNMBR FROM GPHN.dbo.vw_VentasGPconConduceCA1 
 WHERE CUSTNMBR IN ( '10155',
'15895',
'18027',
'18982',
'21346',
'30344',
'31711',
'33325',
'33336',
'33884',
'33921',
'34214'

) AND DOCDATE BETWEEN '20151001' AND '20151031'
)

---v3

 SELECT * FROM GPHN.dbo.vw_VentasGPconConduceCA1 
 WHERE CUSTNMBR IN ( '32799'
) AND DOCDATE BETWEEN '20151001' AND '20151031'
 
 SELECT * FROM PalmComSync..GP_CLIENTEDIASRUTA
 WHERE CodCliente IN ('32170'
)

SELECT c.IdClase,DOCID, CUSTNMBR,CUSTNAME,SOPNUMBE,DOCDATE,ITEMNMBR,ITEMDESC,UNITPRCE,QUANTITY,XTNDPRCE, c.IdZona,c.NombreRuta,c.ZonaResponsable
FROM dbo.vw_VentasGPconConduceCA1 v INNER JOIN  vw_Clientes_CSR c ON RTRIM(v.CUSTNMBR)=RTRIM(c.CodCliente) 
WHERE   DOCDATE BETWEEN '20161001' AND '20151231' AND DOCID NOT IN( 'A0100800101','A0100800115','A0100800114')  AND ITEMNMBR ='PT100' AND NombreRuta LIKE 'SD100%'
AND CUSTNMBR IN ( '32799')
----32799

 
 SELECT  * FROM SOP10106
 SELECT * FROM RM30201
 
 --Venta Planta
 SELECT r.CUSTCLAS,v.CUSTNMBR,r.CUSTNAME,SUM(QUANTITY)CANTIDAD,SUM(XTNDPRCE)MONTO
 FROM vw_VentasGPconConduceCA1 v INNER JOIN RM00101 r ON v.CUSTNMBR=r.CUSTNMBR
 WHERE DOCDATE BETWEEN '20150101' AND '20151231' AND DOCID   IN( 'PALMFACTURA','CONDUCE','PEDIDO','MANUAL')  AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' AND r.CUSTCLAS<>'PUESTO DE VENTA'  AND r.CUSTCLAS<>'DISTRIBUIDOR'
 AND UNITPRCE<>0
 GROUP BY  r.CUSTCLAS,v.CUSTNMBR,r.CUSTNAME
 
 
 SELECT r.CUSTCLAS,v.CUSTNMBR,r.CUSTNAME,SUM(QUANTITY),SUM(XTNDPRCE)
 FROM dbo.vw_VentasGPconConduceCA1 v INNER JOIN RM00101 r ON v.CUSTNMBR=r.CUSTNMBR
 WHERE UNITPRCE=0 AND DOCDATE BETWEEN '20150101' AND '20151231' AND ITEMNMBR='PT100' AND LOCNCODE='SANISIDRO'
 GROUP BY  r.CUSTCLAS,v.CUSTNMBR,r.CUSTNAME
 
 
 ---Puesto de ventas
  SELECT r.CUSTCLAS,v.CUSTNMBR,r.CUSTNAME,SUM(QUANTITY)CANTIDAD,SUM(XTNDPRCE)MONTO
 FROM dbo.vw_VentasGPconConduceCA1 v INNER JOIN RM00101 r ON v.CUSTNMBR=r.CUSTNMBR
 WHERE DOCDATE BETWEEN '20150101' AND '20151231'  AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' AND r.CUSTCLAS='PUESTO DE VENTA' 
 AND UNITPRCE<>0
 GROUP BY r.CUSTCLAS,v.CUSTNMBR,r.CUSTNAME
 
  ---DISTRIBUIDOR
  SELECT r.CUSTCLAS,v.CUSTNMBR,r.CUSTNAME,SUM(QUANTITY)CANTIDAD,SUM(XTNDPRCE)MONTO
 FROM dbo.vw_VentasGPconConduceCA1 v INNER JOIN RM00101 r ON v.CUSTNMBR=r.CUSTNMBR
 WHERE DOCDATE BETWEEN '20150101' AND '20151231'  AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' AND r.CUSTCLAS='DISTRIBUIDOR'
 AND UNITPRCE<>0
 GROUP BY r.CUSTCLAS,v.CUSTNMBR,r.CUSTNAME
 
 
 SELECT IdZona,NombreRuta,COUNT(CodCliente) FROM PalmComSync..vw_Clientes_CSR
 WHERE NombreRuta LIKE 'SD100-09%'
 GROUP BY IdZona,NombreRuta
 
 
 SELECT * FROM PalmComSync..OUT_CONFIG
 WHERE IDVENDEDOR='5119'
 
 
 SELECT * FROM RM00101
 WHERE CUSTCLAS='DISTRIBUIDOR'
 
 SELECT * FROM SITGPIntegration..RelacionConduce
 WHERE NoDocumento='SANI9999009153'
 
 
 SELECT c.IdClase,DOCID, CUSTNMBR,CUSTNAME,v.SOPNUMBE,DOCDATE,ITEMNMBR,ITEMDESC,UNITPRCE,QUANTITY,XTNDPRCE, c.IdZona,c.NombreRuta,c.ZonaResponsable ,s.USERDEF1
FROM dbo.vw_VentasGPconConduceCA1 v INNER JOIN  vw_Clientes_CSR c ON RTRIM(v.CUSTNMBR)=RTRIM(c.CodCliente) INNER JOIN SOP10106 s ON v.SOPNUMBE=s.SOPNUMBE
WHERE   DOCDATE BETWEEN '20150101' AND '20151231' AND DOCID  IN( 'A0100800101','A0100800115','A0100800114')  AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' --AND NombreRuta is null


 
 
 SELECT c.IdClase,DOCID, CUSTNMBR,CUSTNAME,v.SOPNUMBE,DOCDATE,ITEMNMBR,ITEMDESC,UNITPRCE,QUANTITY,XTNDPRCE
FROM vw_VentasGP v INNER JOIN  vw_Clientes_CSR c ON RTRIM(v.CUSTNMBR)=RTRIM(c.CodCliente)
WHERE   DOCDATE BETWEEN '20150101' AND '20151231' AND DOCID  IN( 'A0100800101','A0100800115','A0100800114')  AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' --AND NombreRuta is null



 
 SELECT DOCID,CUSTNMBR,CUSTNAME, SUM(QUANTITY),SUM(XTNDPRCE)
FROM vw_VentasGPconConduceCA1 v --INNER JOIN  vw_Clientes_CSR c ON RTRIM(v.CUSTNMBR)=RTRIM(c.CodCliente)
WHERE   DOCDATE BETWEEN '20150101' AND '20151231' AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' AND DOCID IN('CONDUCE','PEDIDO')
GROUP BY DOCID,CUSTNMBR,CUSTNAME


 SELECT DOCID,CUSTNMBR,CUSTNAME, SUM(QUANTITY),SUM(XTNDPRCE)
FROM vw_VentasGPconConduceCA1 v --INNER JOIN  vw_Clientes_CSR c ON RTRIM(v.CUSTNMBR)=RTRIM(c.CodCliente)
WHERE   DOCDATE BETWEEN '20150101' AND '20151231' AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' AND DOCID 
NOT IN('CONDUCE','PEDIDO','PALMFACTURA') AND CUSTNMBR IN (
 SELECT CUSTNMBR
FROM vw_VentasGPconConduceCA1 v --INNER JOIN  vw_Clientes_CSR c ON RTRIM(v.CUSTNMBR)=RTRIM(c.CodCliente)
WHERE   DOCDATE BETWEEN '20150101' AND '20151231' AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' AND DOCID IN('CONDUCE','PEDIDO')


)
GROUP BY DOCID,CUSTNMBR,CUSTNAME




 SELECT DOCID,SUM(QUANTITY)CANTIDAD,SUM(XTNDPRCE)MONTO
 FROM dbo.vw_VentasGPconConduceCA1 v INNER JOIN RM00101 r ON v.CUSTNMBR=r.CUSTNMBR
 WHERE DOCDATE BETWEEN '20150101' AND '20151231'  AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' AND r.CUSTCLAS='PUESTO DE VENTA' 
 AND UNITPRCE<>0
 GROUP BY DOCID
 
 
 --Planta
  SELECT DOCID,SUM(QUANTITY)CANTIDAD,SUM(XTNDPRCE)MONTO
 FROM vw_VentasGPconConduceCA1 v INNER JOIN RM00101 r ON v.CUSTNMBR=r.CUSTNMBR
 WHERE DOCDATE BETWEEN '20150101' AND '20151231' AND DOCID NOT  IN( 'PALMFACTURA','CONDUCE','PEDIDO','MANUAL')  AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' AND r.CUSTCLAS<>'PUESTO DE VENTA'  AND r.CUSTCLAS<>'DISTRIBUIDOR'
 AND UNITPRCE<>0 AND v.CUSTNMBR NOT IN( SELECT CUSTNMBR
FROM vw_VentasGPconConduceCA1 v1 --INNER JOIN  vw_Clientes_CSR c ON RTRIM(v.CUSTNMBR)=RTRIM(c.CodCliente)
WHERE   DOCDATE BETWEEN '20150101' AND '20151231' AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' AND DOCID IN('CONDUCE','PEDIDO')
GROUP BY DOCID,CUSTNMBR,CUSTNAME)
 GROUP BY  DOCID
 
 --RANCHERO
   SELECT DOCID,SUM(QUANTITY)CANTIDAD,SUM(XTNDPRCE)MONTO
 FROM vw_VentasGPconConduceCA1 v INNER JOIN RM00101 r ON v.CUSTNMBR=r.CUSTNMBR
 WHERE DOCDATE BETWEEN '20150101' AND '20151231' AND DOCID  IN( 'PALMFACTURA','CONDUCE','PEDIDO','MANUAL')  
 AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' AND r.CUSTCLAS<>'PUESTO DE VENTA'  AND r.CUSTCLAS<>'DISTRIBUIDOR'
 AND UNITPRCE<>0 
 GROUP BY  DOCID
 
 
 
  SELECT c.CUSTCLAS,DOCID, c.CUSTNMBR,c.CUSTNAME,SUM(QUANTITY)'CANT',SUM(XTNDPRCE)'MONTO',s.USERDEF1
FROM dbo.vw_VentasGPconConduceCA1 v INNER JOIN  RM00101 c ON RTRIM(v.CUSTNMBR)=RTRIM(c.CUSTNMBR) INNER JOIN SOP10106 s ON v.SOPNUMBE=s.SOPNUMBE
WHERE   DOCDATE BETWEEN '20150101' AND '20151231' AND DOCID  NOT IN( 'A0100800101','A0100800115','A0100800114')  AND ITEMNMBR ='PT100' AND LOCNCODE='SANISIDRO' --AND NombreRuta is null
AND c.CUSTCLAS<>'PUESTO DE VENTA'  AND c.CUSTCLAS<>'DISTRIBUIDOR' AND UNITPRCE<>0
GROUP BY c.CUSTCLAS,DOCID, c.CUSTNMBR,c.CUSTNAME,s.USERDEF1







SELECT v.LOCNCODE,
		v.ITEMNMBR,
		v.ITEMDESC,
		'CANT_CRED'=SUM(CASE WHEN v.PYMTRCVD=v.DOCAMNT THEN 0 ELSE QUANTITY END),
		'VALOR_CRED'=SUM(CASE WHEN v.PYMTRCVD=v.DOCAMNT THEN 0 ELSE XTNDPRCE END),
		'CANT_CONT'=SUM(CASE WHEN v.PYMTRCVD=v.DOCAMNT THEN QUANTITY ELSE 0 END),
		'VALOR_CONT'=SUM(CASE WHEN v.PYMTRCVD=v.DOCAMNT THEN XTNDPRCE ELSE 0 END ),
		SUM( XTNDPRCE)'TOTAL_VALOR' ,
		SUM( QUANTITY)'TOTAL_CANT' 
		FROM  vw_VentasGPconConduce1  as v with(nolock)
WHERE v.DOCDATE BETWEEN '20150101' AND '20151231' AND  
v.SOPNUMBE NOT IN (SELECT ORIGNUMB FROM SOP30200  WHERE SOPTYPE=4 ) AND LOCNCODE='SANISIDRO' --AND UNITPRCE=0
GROUP BY v.LOCNCODE,v.ITEMNMBR,v.ITEMDESC


SELECT v.DOCID,
		SUM( XTNDPRCE)'TOTAL_VALOR' ,
		SUM( QUANTITY)'TOTAL_CANT' 
		FROM  vw_VentasGPconConduceCA1  as v with(nolock)
WHERE v.DOCDATE BETWEEN '20150101' AND '20151231' AND  CUSTNMBR NOT IN ('19212','28024','30850','34143','28459','34136','21185','17817','23002','10480','10479','18230','34156') AND
v.SOPNUMBE NOT IN (SELECT ORIGNUMB FROM SOP30200  WHERE SOPTYPE=4 ) AND LOCNCODE='SANISIDRO' AND ITEMNMBR='PT100' --AND UNITPRCE=0 
AND CUSTNMBR NOT IN (SELECT CUSTNMBR FROM RM00101
WHERE CUSTCLAS='PUESTO DE VENTA'  AND CUSTCLAS='DISTRIBUIDOR')
GROUP BY v.DOCID